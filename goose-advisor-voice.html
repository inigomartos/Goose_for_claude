<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"/>
<title>Goose â€” AI Financial Advisory</title>
<link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><rect width='100' height='100' rx='14' fill='%231A1A1A'/><text y='68' x='18' font-size='60'>ðŸª¿</text></svg>"/>
<link href="https://fonts.googleapis.com/css2?family=Libre+Baskerville:wght@400;700&family=Outfit:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;500;600&display=swap" rel="stylesheet"/>
<script src="https://elevenlabs.io/convai-widget/index.js" async type="text/javascript"></script>
<style>
*{box-sizing:border-box;margin:0;padding:0}
body{font-family:'Outfit',sans-serif;background:#F6F5F0;color:#1A1A1A;-webkit-font-smoothing:antialiased}
@keyframes fadeIn{from{opacity:0;transform:translateY(10px)}to{opacity:1;transform:translateY(0)}}
@keyframes slideUp{from{opacity:0;transform:translateY(40px)}to{opacity:1;transform:translateY(0)}}
@keyframes pulse{0%,100%{opacity:1}50%{opacity:.5}}
.mn{font-family:'JetBrains Mono',monospace}.sf{font-family:'Libre Baskerville',serif}
.hs::-webkit-scrollbar{display:none}.hs{-ms-overflow-style:none;scrollbar-width:none}
elevenlabs-convai{position:fixed!important;bottom:20px!important;right:20px!important;z-index:300!important}
</style>
</head>
<body>
<div id="root"></div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/react/18.2.0/umd/react.production.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/react-dom/18.2.0/umd/react-dom.production.min.js"></script>
<script>
const e=React.createElement,{useState,useEffect,useRef,useCallback}=React;

const API_URL="http://168.231.87.2:8000";
const AGENT_ID="agent_3901kgmswk5ve9etvy9c1h4g2e40";

const CATEGORIES=["All","ETFs","Stocks","Funds"];
const INVESTMENTS=[
{type:"ETFs",ticker:"GLBX",name:"Global Exposure ETF",desc:"Diversified worldwide equities across 47 countries",price:142.37,change:2.14,pct:1.53,risk:"Medium",tags:["Global","Equities"],spark:[38,40,37,42,45,43,48,46,50,52,49,55],yld:"1.8%",er:"0.09%"},
{type:"Stocks",ticker:"NVDA",name:"NVIDIA Corporation",desc:"Leading AI & GPU semiconductor company",price:878.35,change:12.47,pct:1.44,risk:"High",tags:["Tech","AI"],spark:[20,25,23,30,28,35,40,38,50,55,52,60],yld:"0.03%",er:null},
{type:"ETFs",ticker:"AIGT",name:"AI & Automation Growth",desc:"Next-generation technology leaders index",price:287.91,change:5.63,pct:1.99,risk:"High",tags:["Tech","Growth"],spark:[20,25,23,30,28,35,40,38,45,50,48,56],yld:"0.4%",er:"0.35%"},
{type:"Funds",ticker:"GSBF",name:"Goose Stable Bond Fund",desc:"Investment-grade corporate & govt bonds",price:24.18,change:0.06,pct:0.25,risk:"Low",tags:["Bonds","Income"],spark:[44,45,44,46,45,47,46,47,48,47,48,49],yld:"4.2%",er:"0.15%"},
{type:"Stocks",ticker:"AAPL",name:"Apple Inc.",desc:"Consumer electronics & services ecosystem",price:213.07,change:-1.23,pct:-0.57,risk:"Medium",tags:["Tech","Consumer"],spark:[50,52,51,53,52,50,49,51,50,48,49,48],yld:"0.52%",er:null},
{type:"Funds",ticker:"GEMF",name:"Goose Emerging Markets",desc:"Active fund targeting high-growth economies",price:63.19,change:1.07,pct:1.72,risk:"High",tags:["Emerging","Active"],spark:[30,28,35,32,38,36,40,37,42,45,43,48],yld:"2.1%",er:"0.65%"},
{type:"ETFs",ticker:"GRNB",name:"Green Bond Climate Fund",desc:"Sustainable fixed income for ESG investors",price:51.08,change:0.22,pct:0.43,risk:"Low",tags:["ESG","Bonds"],spark:[44,45,44,46,45,47,46,47,48,47,48,49],yld:"3.6%",er:"0.12%"},
{type:"Stocks",ticker:"JPM",name:"JPMorgan Chase & Co.",desc:"Largest US bank by assets, diversified financials",price:198.62,change:3.15,pct:1.61,risk:"Medium",tags:["Finance","Dividends"],spark:[40,42,41,44,43,46,45,48,47,50,52,54],yld:"2.3%",er:null},
{type:"Funds",ticker:"GDVA",name:"Goose Dividend Aristocrats",desc:"Curated portfolio of 25+ year dividend growers",price:98.44,change:-0.31,pct:-0.31,risk:"Low",tags:["Dividends","Value"],spark:[50,49,51,50,52,51,50,51,52,51,50,49],yld:"3.8%",er:"0.40%"}
];

const STEPS=[
{num:"01",icon:"\u{1F4AC}",title:"Understand your position",desc:"Through a natural conversation, we gather your financial situation \u2014 savings capacity, risk appetite, investment horizon, existing knowledge, and personal values."},
{num:"02",icon:"\u{1F3DB}\uFE0F",title:"Human-designed frameworks",desc:"Your profile is mapped against portfolio structures built and maintained by human financial experts. These frameworks encode regulatory requirements, diversification principles, and proven allocation strategies."},
{num:"03",icon:"\u{1F916}",title:"AI-powered product matching",desc:"Within those frameworks, AI applies a mix of deterministic logic (regulatory compliance, suitability rules) and intelligent matching to surface specific products that fit your unique profile from thousands of options."},
{num:"04",icon:"\u{1F504}",title:"Continuous refinement",desc:"As markets shift or your life changes, the system re-evaluates. Humans oversee the structural decisions; AI handles the scale of personalization. You always see why something was suggested."}
];

const PORTFOLIO={
totalValue:48752.30,dayChange:312.45,dayChangePct:0.64,
riskScore:5.8,riskLabel:"Moderate",diversification:82,esgScore:74,
holdings:[
{ticker:"GSBF",name:"Goose Stable Bond Fund",alloc:28,value:13650.64,change:0.25},
{ticker:"GRNB",name:"Green Bond Climate Fund",alloc:22,value:10725.51,change:0.43},
{ticker:"GLBX",name:"Global Exposure ETF",alloc:18,value:8775.41,change:1.53},
{ticker:"AAPL",name:"Apple Inc.",alloc:12,value:5850.28,change:-0.57},
{ticker:"GDVA",name:"Goose Dividend Aristocrats",alloc:10,value:4875.23,change:-0.31},
{ticker:"JPM",name:"JPMorgan Chase & Co.",alloc:10,value:4875.23,change:1.61}
],
allocation:[
{label:"Bonds & Fixed Income",pct:50,color:"#2D6A4F"},
{label:"Global Equities",pct:18,color:"#52B788"},
{label:"Tech & Growth",pct:12,color:"#74C69D"},
{label:"Financials",pct:10,color:"#95D5B2"},
{label:"Dividends",pct:10,color:"#B7E4C7"}
],
profile:[
{label:"Risk tolerance",value:5.8,max:10,color:"#E76F51"},
{label:"Time horizon",value:7.2,max:10,color:"#2D6A4F"},
{label:"ESG preference",value:7.4,max:10,color:"#52B788"},
{label:"Income focus",value:6.5,max:10,color:"#E9C46A"},
{label:"Growth focus",value:4.2,max:10,color:"#264653"}
]
};

function up(v){return v>=0}
function fmt(n){var p=n.toFixed(2).split(".");return p[0].replace(/\B(?=(\d{3})+(?!\d))/g,",")+"."+p[1]}

function GooseIcon(p){
  var s=p.size||34;
  return e("svg",{width:s,height:s,viewBox:"0 0 100 100",fill:"none"},
    e("rect",{width:100,height:100,rx:8,fill:"#1A1A1A"}),
    e("g",{transform:"translate(12,14) scale(0.76)"},
      e("path",{d:"M82 18c-2-4-6-7-11-8-3-1-7 0-10 2L48 24c-3 2-6 5-7 9l-4 12c-1 3-3 5-6 6L16 56c-4 2-7 5-8 9-1 3 0 7 2 10l4 5c2 3 5 4 9 4h6l12-3c4-1 7-4 9-7l8-14c1-2 3-3 5-3l14-1c4 0 7-2 9-5l3-6c2-4 2-8 1-12z",fill:"white"}),
      e("path",{d:"M48 30c2-1 4 0 5 1 1 2 0 4-1 5-2 1-4 0-5-1-1-2 0-4 1-5z",fill:"#1A1A1A"})
    )
  );
}

function Spark(p){
  var d=p.data,isUp=p.up,w=80,h=28,mn=Math.min.apply(null,d),mx=Math.max.apply(null,d),r=mx-mn||1;
  var pts=d.map(function(v,i){return (i/(d.length-1))*w+","+(h-((v-mn)/r)*(h-4)-2)}).join(" ");
  var c=isUp?"#2D6A4F":"#C1484E";
  return e("svg",{width:w,height:h,viewBox:"0 0 "+w+" "+h},
    e("defs",null,e("linearGradient",{id:"sg"+(isUp?1:0),x1:0,y1:0,x2:0,y2:1},e("stop",{offset:"0%",stopColor:c,stopOpacity:.18}),e("stop",{offset:"100%",stopColor:c,stopOpacity:0}))),
    e("polygon",{points:"0,"+h+" "+pts+" "+w+","+h,fill:"url(#sg"+(isUp?1:0)+")"}),
    e("polyline",{points:pts,fill:"none",stroke:c,strokeWidth:1.5,strokeLinecap:"round",strokeLinejoin:"round"})
  );
}

function BarComp(p){
  var pct=Math.min(100,Math.max(0,(p.value/p.max)*100));
  return e("div",{style:{width:"100%",height:6,background:"#ECEAE3",borderRadius:6}},
    e("div",{style:{width:pct+"%",height:"100%",background:p.color,borderRadius:6,transition:"width .6s ease"}})
  );
}

function DonutComp(p){
  var data=p.data,total=data.reduce(function(s,d){return s+d.pct},0),sz=132,sw=20,r=(sz-sw)/2,ci=2*Math.PI*r;
  var segs=[],cum=0;
  for(var i=0;i<data.length;i++){var segL=(data[i].pct/total)*ci;var off=(cum/total)*ci;segs.push({color:data[i].color,segLen:segL,offset:off});cum+=data[i].pct}
  return e("svg",{width:sz,height:sz,viewBox:"0 0 "+sz+" "+sz,style:{transform:"rotate(-90deg)",flexShrink:0}},
    segs.map(function(sg,i){return e("circle",{key:i,cx:sz/2,cy:sz/2,r:r,fill:"none",stroke:sg.color,strokeWidth:sw,strokeDasharray:sg.segLen+" "+(ci-sg.segLen),strokeDashoffset:-sg.offset})})
  );
}

function ChatIcon(p){
  return e("svg",{width:p.s||14,height:p.s||14,viewBox:"0 0 24 24",fill:"none",stroke:p.c||"#999",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"},
    e("path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"})
  );
}
function SendIcon(){
  return e("svg",{width:16,height:16,viewBox:"0 0 24 24",fill:"none",stroke:"#fff",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"},
    e("line",{x1:22,y1:2,x2:11,y2:13}),e("polygon",{points:"22 2 15 22 11 13 2 9 22 2"})
  );
}
function PhoneIcon(p){
  var c=p.c||"#fff",s=p.s||16;
  return e("svg",{width:s,height:s,viewBox:"0 0 24 24",fill:"none",stroke:c,strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"},
    e("path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72c.127.96.361 1.903.7 2.81a2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45c.907.339 1.85.573 2.81.7A2 2 0 0 1 22 16.92z"})
  );
}
function MicIcon(p){
  var c=p.c||"#fff",s=p.s||18;
  return e("svg",{width:s,height:s,viewBox:"0 0 24 24",fill:"none",stroke:c,strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"},
    e("path",{d:"M12 1a3 3 0 0 0-3 3v8a3 3 0 0 0 6 0V4a3 3 0 0 0-3-3z"}),
    e("path",{d:"M19 10v2a7 7 0 0 1-14 0v-2"}),
    e("line",{x1:12,y1:19,x2:12,y2:23}),
    e("line",{x1:8,y1:23,x2:16,y2:23})
  );
}

function FlowDiagram(){
  var boxes=[{label:"Your Profile",sub:"Risk \xB7 Savings \xB7 Goals",color:"#264653",bg:"#26465310"},{label:"Human Frameworks",sub:"Regulation \xB7 Allocation",color:"#2D6A4F",bg:"#2D6A4F10"},{label:"AI Matching",sub:"Deterministic + Intelligent",color:"#E76F51",bg:"#E76F5110"},{label:"Suggestions",sub:"Products tailored to you",color:"#2D6A4F",bg:"#2D6A4F10"}];
  return e("div",{style:{display:"flex",alignItems:"center",gap:0,overflowX:"auto",padding:"4px 0"},className:"hs"},
    boxes.map(function(b,i){return e("div",{key:i,style:{display:"flex",alignItems:"center",flexShrink:0}},
      e("div",{style:{background:b.bg,border:"1px solid "+b.color+"20",borderRadius:12,padding:"14px 16px",textAlign:"center",minWidth:110}},
        e("div",{style:{fontSize:12.5,fontWeight:600,color:b.color,marginBottom:3}},b.label),
        e("div",{style:{fontSize:10.5,color:"#999",lineHeight:1.4}},b.sub)
      ),
      i<boxes.length-1?e("svg",{width:28,height:16,viewBox:"0 0 28 16",style:{flexShrink:0,margin:"0 -2px"}},e("path",{d:"M4 8h16M16 3l6 5-6 5",fill:"none",stroke:"#ccc",strokeWidth:1.5,strokeLinecap:"round",strokeLinejoin:"round"})):null
    )})
  );
}

function App(){
  var _page=useState("invest"),page=_page[0],setPage=_page[1];
  var _cat=useState("All"),cat=_cat[0],setCat=_cat[1];
  var _exp=useState(null),expanded=_exp[0],setExpanded=_exp[1];
  var _su=useState(false),showSignUp=_su[0],setShowSignUp=_su[1];
  var _ask=useState(null),askingAbout=_ask[0],setAskingAbout=_ask[1];
  var _ci=useState(""),chatInput=_ci[0],setChatInput=_ci[1];
  var _cm=useState([]),chatMessages=_cm[0],setChatMessages=_cm[1];
  var _cd=useState(false),chatDisclaimed=_cd[0],setChatDisclaimed=_cd[1];

  // Advisor state
  var _ai=useState(""),advInput=_ai[0],setAdvInput=_ai[1];
  var _am=useState([]),advMessages=_am[0],setAdvMessages=_am[1];
  var _al=useState(false),advLoading=_al[0],setAdvLoading=_al[1];
  var _at=useState(false),showAudit=_at[0],setShowAudit=_at[1];
  var _ad=useState(null),auditData=_ad[0],setAuditData=_ad[1];
  var _ap=useState(null),latestProfile=_ap[0],setLatestProfile=_ap[1];
  var _sid=useState("goose-"+Date.now()),sessionId=_sid[0];
  var _wv=useState(false),widgetVisible=_wv[0],setWidgetVisible=_wv[1];
  var chatEndRef=useRef(null);

  var filtered=cat==="All"?INVESTMENTS:INVESTMENTS.filter(function(i){return i.type===cat});

  // Auto-scroll advisor chat
  useEffect(function(){
    if(chatEndRef.current)chatEndRef.current.scrollIntoView({behavior:"smooth"});
  },[advMessages,advLoading]);

  // Toggle ElevenLabs widget visibility
  useEffect(function(){
    var el=document.querySelector("elevenlabs-convai");
    if(el){el.style.display=widgetVisible?"block":"none"}
  },[widgetVisible]);

  // Show widget when on advisor page, hide otherwise
  useEffect(function(){
    if(page==="advisor"){
      // Mount the widget if not present
      if(!document.querySelector("elevenlabs-convai")){
        var w=document.createElement("elevenlabs-convai");
        w.setAttribute("agent-id",AGENT_ID);
        document.body.appendChild(w);
      }
      setWidgetVisible(true);
    }else{
      setWidgetVisible(false);
    }
  },[page]);

  function sendMsg(inv){
    if(!chatInput.trim())return;
    setChatMessages(function(prev){return prev.concat([{from:"user",text:chatInput.trim()},{from:"ai",text:"Here\u2019s what I can share about "+inv.ticker+": this is a demo response. In the live product, the AI would provide detailed information about "+inv.name+" based on your question."}])});
    setChatInput("");
  }

  function sendAdvisorMsg(){
    if(!advInput.trim()||advLoading)return;
    var msg=advInput.trim();
    setAdvInput("");
    setAdvMessages(function(p){return p.concat([{from:"user",text:msg}])});
    setAdvLoading(true);
    fetch(API_URL+"/chat/"+sessionId,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({message:msg})})
      .then(function(r){return r.json()})
      .then(function(d){setAdvMessages(function(p){return p.concat([{from:"ai",text:d.reply}])});setAdvLoading(false)})
      .catch(function(err){setAdvMessages(function(p){return p.concat([{from:"ai",text:"Connection error. Please try again."}])});setAdvLoading(false)});
  }

  function fetchAudit(){
    Promise.all([fetch(API_URL+"/audit"),fetch(API_URL+"/audit/latest-profile")])
      .then(function(rs){return Promise.all(rs.map(function(r){return r.json()}))})
      .then(function(ds){setAuditData(ds[0]);setLatestProfile(ds[1])})
      .catch(function(){});
  }

  useEffect(function(){if(showAudit)fetchAudit()},[showAudit]);

  // Nav button helper
  function nb(id,label){
    return e("button",{key:id,onClick:function(){setPage(id);setExpanded(null);setAskingAbout(null)},
      style:{background:"none",border:"none",fontFamily:"'Outfit',sans-serif",fontSize:13,fontWeight:page===id?600:500,color:page===id?"#1A1A1A":"#999",padding:"14px 0",cursor:"pointer",position:"relative",letterSpacing:.2,borderBottom:page===id?"2px solid #1A1A1A":"2px solid transparent"}
    },label);
  }

  // â”€â”€ HEADER â”€â”€
  var header=e("header",{style:{background:"#fff",borderBottom:"1px solid #ECEAE3",position:"sticky",top:0,zIndex:100}},
    e("div",{style:{maxWidth:540,margin:"0 auto",padding:"0 20px"}},
      e("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",paddingTop:14,paddingBottom:6}},
        e("div",{style:{display:"flex",alignItems:"center",gap:10,cursor:"pointer"},onClick:function(){setPage("invest")}},
          e(GooseIcon,{size:36}),
          e("div",null,
            e("span",{className:"sf",style:{fontSize:17,fontWeight:700,letterSpacing:-.3}},"GOOSE"),
            e("span",{style:{fontSize:10,color:"#999",display:"block",marginTop:-3,letterSpacing:.5,fontWeight:500}},"AI Financial Advisory")
          )
        ),
        e("button",{onClick:function(){setPage("advisor");setShowSignUp(false)},style:{background:"#2D6A4F",color:"#fff",border:"none",fontFamily:"'Outfit',sans-serif",fontSize:13,fontWeight:600,padding:"10px 22px",borderRadius:50,cursor:"pointer",whiteSpace:"nowrap",display:"flex",alignItems:"center",gap:7}},e(PhoneIcon,{s:14,c:"#fff"}),"Talk to Advisor")
      ),
      e("nav",{style:{display:"flex",gap:24}},nb("invest","Investments"),nb("how","How It Works"),nb("portfolio","My Portfolio"),nb("advisor","AI Advisor"))
    )
  );

  // â”€â”€ SIGN UP MODAL â”€â”€
  var modal=!showSignUp?null:e(React.Fragment,null,
    e("div",{onClick:function(){setShowSignUp(false)},style:{position:"fixed",inset:0,background:"rgba(0,0,0,.3)",zIndex:200,animation:"fadeIn .2s ease"}}),
    e("div",{style:{position:"fixed",bottom:0,left:"50%",transform:"translateX(-50%)",width:"100%",maxWidth:540,background:"#fff",borderRadius:"20px 20px 0 0",zIndex:201,padding:"32px 24px 40px",animation:"slideUp .35s ease",maxHeight:"85vh",overflowY:"auto"}},
      e("button",{onClick:function(){setShowSignUp(false)},style:{position:"absolute",top:16,right:20,background:"none",border:"none",fontSize:22,cursor:"pointer",color:"#999",width:36,height:36,display:"flex",alignItems:"center",justifyContent:"center",borderRadius:"50%"}},"\xD7"),
      e("div",{style:{textAlign:"center",marginBottom:28}},
        e("div",{style:{display:"inline-block",marginBottom:12}},e(GooseIcon,{size:48})),
        e("h2",{className:"sf",style:{fontSize:22,fontWeight:700,marginBottom:6}},"Talk to your AI Advisor"),
        e("p",{style:{fontSize:14,color:"#888",lineHeight:1.6}},"Choose how you\u2019d like to connect \u2014 always available, always private.")
      ),
      e("div",{style:{display:"flex",flexDirection:"column",gap:12,marginBottom:28}},
        [{icon:"\u{1F4AC}",title:"Text Chat",sub:"Instant \xB7 24/7",desc:"Type your questions and get detailed, sourced answers with charts and breakdowns.",badge:"Most popular",bc:"#2D6A4F"},
         {icon:"\u{1F399}\uFE0F",title:"Voice Mode",sub:"Natural \xB7 Hands-free",desc:"Speak naturally and hear strategies explained in a conversational way.",badge:null,bc:null},
         {icon:"\u{1F4DE}",title:"Call AI Agent",sub:"Deep dive \xB7 On demand",desc:"Start a dedicated voice call for portfolio reviews, onboarding, or MiFID II suitability assessment.",badge:"New",bc:"#E76F51"}
        ].map(function(c,i){
          return e("div",{key:i,onClick:function(){setShowSignUp(false);setPage("advisor")},
            style:{background:"#F6F5F0",borderRadius:14,padding:"18px 20px",display:"flex",gap:16,alignItems:"flex-start",cursor:"pointer",transition:"all .2s",border:"1px solid transparent"}},
            e("div",{style:{width:46,height:46,borderRadius:12,background:"#fff",display:"flex",alignItems:"center",justifyContent:"center",fontSize:22,flexShrink:0}},c.icon),
            e("div",{style:{flex:1}},
              e("div",{style:{display:"flex",alignItems:"center",gap:8,marginBottom:2}},
                e("span",{style:{fontWeight:600,fontSize:15}},c.title),
                c.badge?e("span",{style:{display:"inline-block",fontSize:10,fontWeight:600,padding:"3px 9px",borderRadius:50,background:c.bc+"14",color:c.bc,letterSpacing:.4}},c.badge):null
              ),
              e("div",{style:{fontSize:11.5,color:"#2D6A4F",fontWeight:500,marginBottom:4}},c.sub),
              e("p",{style:{fontSize:13,color:"#888",lineHeight:1.55,margin:0}},c.desc)
            )
          );
        })
      ),
      e("button",{onClick:function(){setShowSignUp(false);setPage("advisor")},style:{background:"#1A1A1A",color:"#fff",border:"none",fontFamily:"'Outfit',sans-serif",fontSize:14,fontWeight:600,padding:"13px 28px",borderRadius:10,cursor:"pointer",width:"100%"}},"Get started free"),
      e("div",{style:{display:"flex",justifyContent:"space-around",textAlign:"center",marginTop:24,paddingTop:20,borderTop:"1px solid #ECEAE3"}},
        [{v:"24/7",l:"Availability"},{v:"<2s",l:"Response"},{v:"E2E",l:"Encrypted"}].map(function(s){
          return e("div",{key:s.l},e("div",{className:"mn",style:{fontSize:18,fontWeight:700}},s.v),e("div",{style:{fontSize:11,color:"#999",fontWeight:500,marginTop:2}},s.l));
        })
      )
    )
  );

  // â”€â”€ INVESTMENTS PAGE â”€â”€
  function investPage(){
    return e("div",{style:{animation:"fadeIn .4s ease"}},
      e("div",{style:{marginBottom:20}},
        e("h1",{className:"sf",style:{fontSize:26,fontWeight:700,lineHeight:1.2,letterSpacing:-.5,marginBottom:6}},"Available options"),
        e("p",{style:{fontSize:13.5,color:"#999",lineHeight:1.5}},"Browse ETFs, stocks, and funds across asset classes")
      ),
      e("div",{style:{display:"flex",gap:8,marginBottom:20}},
        CATEGORIES.map(function(c){return e("button",{key:c,onClick:function(){setCat(c);setExpanded(null);setAskingAbout(null)},
          style:{background:cat===c?"#1A1A1A":"none",border:"1px solid "+(cat===c?"#1A1A1A":"#E0DDD5"),fontFamily:"'Outfit',sans-serif",fontSize:12,fontWeight:500,color:cat===c?"#fff":"#999",padding:"7px 16px",borderRadius:50,cursor:"pointer",letterSpacing:.3}
        },c)})
      ),
      e("div",{style:{display:"flex",flexDirection:"column",gap:10}},
        filtered.map(function(inv,idx){
          var key=inv.ticker+inv.type;
          var isUp=up(inv.change);
          var isExp=expanded===key;
          var isAsking=askingAbout===inv.ticker;
          var riskC=inv.risk==="Low"?"#2D6A4F":inv.risk==="Medium"?"#B8860B":"#C1484E";
          var typeC=inv.type==="ETFs"?"#4A6FA5":inv.type==="Stocks"?"#B8860B":"#7B5EA7";
          var typeL=inv.type==="ETFs"?"ETF":inv.type==="Stocks"?"Stock":"Fund";

          return e("div",{key:key,onClick:function(){setExpanded(isExp?null:key)},
            style:{background:"#fff",border:"1px solid "+(isExp?"rgba(45,106,79,.3)":"#ECEAE3"),borderRadius:14,padding:20,cursor:"pointer",transition:"all .25s",animation:"fadeIn .35s ease both",animationDelay:idx*.04+"s",boxShadow:isExp?"0 2px 16px rgba(45,106,79,.06)":"none"}
          },
            e("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start"}},
              e("div",{style:{flex:1,minWidth:0}},
                e("div",{style:{display:"flex",alignItems:"center",gap:7,marginBottom:5,flexWrap:"wrap"}},
                  e("span",{className:"mn",style:{fontSize:14,fontWeight:600,letterSpacing:.3}},inv.ticker),
                  e("span",{style:{fontFamily:"'Outfit',sans-serif",fontSize:9.5,fontWeight:600,letterSpacing:.6,textTransform:"uppercase",padding:"3px 8px",borderRadius:4,background:typeC+"10",color:typeC}},typeL),
                  e("span",{style:{display:"inline-block",fontSize:10,fontWeight:600,padding:"3px 9px",borderRadius:50,background:riskC+"10",color:riskC,letterSpacing:.4}},inv.risk)
                ),
                e("div",{style:{fontSize:13.5,fontWeight:500,color:"#333",marginBottom:1}},inv.name),
                e("div",{style:{fontSize:12,color:"#aaa"}},inv.desc)
              ),
              e("div",{style:{textAlign:"right",paddingLeft:12,flexShrink:0}},
                e("div",{className:"mn",style:{fontSize:17,fontWeight:700,letterSpacing:-.5}},"$"+inv.price.toFixed(2)),
                e("div",{className:"mn",style:{fontSize:12,fontWeight:500,color:isUp?"#2D6A4F":"#C1484E"}},(isUp?"+":"")+inv.change.toFixed(2)+" ("+(isUp?"+":"")+inv.pct.toFixed(2)+"%)")
              )
            ),
            e("div",{style:{marginTop:12,display:"flex",alignItems:"center",justifyContent:"space-between"}},
              e(Spark,{data:inv.spark,up:isUp}),
              e("div",{style:{display:"flex",alignItems:"center",gap:8}},
                e("div",{style:{display:"flex",gap:5}},inv.tags.map(function(t){return e("span",{key:t,style:{display:"inline-block",fontSize:10,fontWeight:600,padding:"3px 9px",borderRadius:50,background:"#F6F5F0",color:"#999",letterSpacing:.4}},t)})),
                e("button",{title:"Ask about "+inv.ticker,onClick:function(ev){ev.stopPropagation();setAskingAbout(isAsking?null:inv.ticker);setChatMessages([]);setChatDisclaimed(false);setChatInput("")},
                  style:{width:30,height:30,borderRadius:8,border:"1px solid #E0DDD5",background:isAsking?"#2D6A4F":"#fff",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",flexShrink:0,transition:"all .2s"}
                },e(ChatIcon,{s:14,c:isAsking?"#fff":"#999"}))
              )
            ),
            isAsking?e("div",{style:{marginTop:14,animation:"fadeIn .25s ease"},onClick:function(ev){ev.stopPropagation()}},
              !chatDisclaimed?
                e("div",{style:{background:"#FFFBEB",border:"1px solid #F5E6B8",borderRadius:10,padding:"14px 16px"}},
                  e("div",{style:{display:"flex",alignItems:"flex-start",gap:10}},
                    e("span",{style:{fontSize:16,lineHeight:1,flexShrink:0}},"\u26A0\uFE0F"),
                    e("div",null,
                      e("div",{style:{fontSize:12.5,fontWeight:600,color:"#92710C",marginBottom:3}},"AI can make mistakes"),
                      e("p",{style:{fontSize:12,color:"#A68B2D",lineHeight:1.55,margin:0}},"Responses are generated by AI and may contain inaccuracies. This is not financial advice. Always verify information independently before making investment decisions."),
                      e("button",{onClick:function(){setChatDisclaimed(true)},style:{marginTop:10,background:"#1A1A1A",color:"#fff",border:"none",fontFamily:"'Outfit',sans-serif",fontSize:12,fontWeight:600,padding:"8px 18px",borderRadius:8,cursor:"pointer"}},"I understand, continue")
                    )
                  )
                )
              :
                e("div",{style:{background:"#F6F5F0",borderRadius:12,padding:14}},
                  e("div",{style:{fontSize:11,color:"#999",fontWeight:500,marginBottom:8,display:"flex",alignItems:"center",gap:5}},e(ChatIcon,{s:12,c:"#999"}),"Ask about "+inv.name),
                  chatMessages.length>0?e("div",{style:{display:"flex",flexDirection:"column",gap:8,marginBottom:10,maxHeight:160,overflowY:"auto"}},
                    chatMessages.map(function(m,mi){return e("div",{key:mi,style:{alignSelf:m.from==="user"?"flex-end":"flex-start",background:m.from==="user"?"#1A1A1A":"#fff",color:m.from==="user"?"#fff":"#333",padding:"8px 12px",borderRadius:10,fontSize:13,lineHeight:1.5,maxWidth:"85%"}},m.text)})
                  ):null,
                  e("div",{style:{display:"flex",gap:8}},
                    e("input",{value:chatInput,onChange:function(ev){setChatInput(ev.target.value)},onKeyDown:function(ev){if(ev.key==="Enter")sendMsg(inv)},placeholder:'e.g. "What sectors does this cover?"',
                      style:{flex:1,border:"1px solid #E0DDD5",borderRadius:8,padding:"9px 12px",fontSize:13,fontFamily:"'Outfit',sans-serif",outline:"none",background:"#fff"}}),
                    e("button",{onClick:function(){sendMsg(inv)},style:{width:38,height:38,borderRadius:8,background:"#1A1A1A",border:"none",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",flexShrink:0}},e(SendIcon))
                  ),
                  e("div",{style:{fontSize:10,color:"#bbb",marginTop:6,fontStyle:"italic"}},"AI-generated \xB7 may contain errors \xB7 not financial advice")
                )
            ):null,
            isExp?e("div",{style:{marginTop:16,paddingTop:16,borderTop:"1px solid #ECEAE3",animation:"fadeIn .25s ease"}},
              e("div",{style:{display:"flex",gap:20,marginBottom:14}},
                inv.yld?e("div",null,e("div",{style:{fontSize:10,color:"#999",fontWeight:500,marginBottom:1}},"Yield"),e("div",{className:"mn",style:{fontSize:14,fontWeight:600,color:"#2D6A4F"}},inv.yld)):null,
                inv.er?e("div",null,e("div",{style:{fontSize:10,color:"#999",fontWeight:500,marginBottom:1}},"Expense ratio"),e("div",{className:"mn",style:{fontSize:14,fontWeight:600}},inv.er)):null,
                e("div",null,e("div",{style:{fontSize:10,color:"#999",fontWeight:500,marginBottom:1}},"Risk level"),e("div",{style:{fontSize:14,fontWeight:600,color:riskC}},inv.risk))
              ),
              e("div",{style:{display:"flex",gap:10}},
                e("button",{onClick:function(ev){ev.stopPropagation()},style:{flex:1,background:"#1A1A1A",color:"#fff",border:"none",fontFamily:"'Outfit',sans-serif",fontSize:14,fontWeight:600,padding:"13px 28px",borderRadius:10,cursor:"pointer"}},"Learn more"),
                e("button",{onClick:function(ev){ev.stopPropagation()},style:{background:"none",color:"#1A1A1A",border:"1px solid #D8D5CC",fontFamily:"'Outfit',sans-serif",fontSize:13,fontWeight:500,padding:"11px 22px",borderRadius:10,cursor:"pointer"}},"Details")
              )
            ):null
          );
        })
      )
    );
  }

  // â”€â”€ HOW IT WORKS PAGE â”€â”€
  function howPage(){
    return e("div",{style:{animation:"fadeIn .4s ease"}},
      e("div",{style:{marginBottom:32}},
        e("h1",{className:"sf",style:{fontSize:28,fontWeight:700,lineHeight:1.25,letterSpacing:-.6,marginBottom:10}},"Why ",e("span",{style:{color:"#2D6A4F"}},"Goose"),"?"),
        e("p",{style:{fontSize:15,color:"#777",lineHeight:1.75}},"Until now, getting targeted investment suggestions that truly fit your personal situation was either too expensive or too generic. Goose makes it possible to deliver this at scale \u2014 combining human expertise with AI precision.")
      ),
      e("div",{style:{background:"#fff",border:"1px solid #ECEAE3",borderRadius:16,padding:24,marginBottom:16}},
        e("div",{style:{fontSize:11,fontWeight:600,letterSpacing:1,textTransform:"uppercase",color:"#2D6A4F",marginBottom:16}},"What makes this different"),
        [{icon:"\u{1F3DB}\uFE0F",title:"Human-designed portfolio structures",desc:"All general allocation frameworks are built and maintained by financial professionals \u2014 not generated by AI. Humans stay in the loop at the structural level."},
         {icon:"\u{1F916}",title:"AI handles the personalization",desc:"Within those frameworks, AI uses deterministic logic (regulations, suitability rules) combined with intelligent matching to find products that fit your specific position from thousands of options."},
         {icon:"\u{1F4B0}",title:"Accessible at scale",desc:"Personalized investment suggestions have historically required expensive advisors. AI lets us deliver this to everyone \u2014 not just high-net-worth clients."}
        ].map(function(v,i){
          return e("div",{key:i,style:{display:"flex",gap:14,alignItems:"flex-start",marginBottom:i<2?14:0}},
            e("div",{style:{width:42,height:42,borderRadius:12,background:"#F6F5F0",display:"flex",alignItems:"center",justifyContent:"center",fontSize:20,flexShrink:0}},v.icon),
            e("div",null,e("div",{style:{fontWeight:600,fontSize:14,marginBottom:3}},v.title),e("p",{style:{fontSize:13,color:"#777",lineHeight:1.6,margin:0}},v.desc))
          );
        })
      ),
      e("div",{style:{background:"#fff",border:"1px solid #ECEAE3",borderRadius:16,padding:24,marginBottom:32}},
        e("div",{style:{fontSize:11,fontWeight:600,letterSpacing:1,textTransform:"uppercase",color:"#999",marginBottom:16}},"Growing trust in AI-assisted finance"),
        e("div",{style:{display:"flex",gap:12,marginBottom:14}},
          [{v:"37%",l:"of Americans trust AI as much or more than humans for financial suggestions"},{v:"82%",l:"of users who followed AI suggestions saw measurable improvements"}].map(function(s,i){
            return e("div",{key:i,style:{flex:1,textAlign:"center",padding:"16px 10px",background:"#2D6A4F08",borderRadius:12}},
              e("div",{className:"mn",style:{fontSize:26,fontWeight:700,color:"#2D6A4F",marginBottom:4}},s.v),
              e("div",{style:{fontSize:11.5,color:"#777",lineHeight:1.5}},s.l)
            );
          })
        )
      ),
      e("div",{style:{marginBottom:10}},
        e("h2",{className:"sf",style:{fontSize:22,fontWeight:700,letterSpacing:-.4,marginBottom:6}},"How it ",e("span",{style:{color:"#2D6A4F"}},"works")),
        e("p",{style:{fontSize:13.5,color:"#999",lineHeight:1.6,marginBottom:16}},"From understanding your position to surfacing relevant products \u2014 with humans and AI each in their proper role.")
      ),
      e("div",{style:{background:"#fff",border:"1px solid #ECEAE3",borderRadius:16,padding:20,marginBottom:28}},e(FlowDiagram)),
      e("div",{style:{display:"flex",flexWrap:"wrap",gap:7,marginBottom:28}},
        [{l:"Risk appetite",em:"\u{1F4C9}",c:"#E76F51"},{l:"Savings capacity",em:"\u{1F4B0}",c:"#2D6A4F"},{l:"Investment horizon",em:"\u23F3",c:"#4A6FA5"},{l:"Knowledge level",em:"\u{1F4DA}",c:"#264653"},{l:"Personal values",em:"\u{1F331}",c:"#52B788"},{l:"Existing portfolio",em:"\u{1F4CA}",c:"#B8860B"}].map(function(r){
          return e("span",{key:r.l,style:{display:"inline-flex",alignItems:"center",gap:5,padding:"7px 13px",borderRadius:50,fontSize:12,fontWeight:500,background:r.c+"0A",color:r.c,border:"1px solid "+r.c+"18"}},e("span",{style:{fontSize:13}},r.em),r.l);
        })
      ),
      STEPS.map(function(s,i){
        return e("div",{key:i,style:{display:"flex",gap:18,alignItems:"flex-start",padding:"22px 0",borderBottom:i<STEPS.length-1?"1px solid #ECEAE3":"none",animation:"fadeIn .4s ease both",animationDelay:i*.07+"s"}},
          e("div",{style:{width:44,height:44,borderRadius:12,background:"#F6F5F0",display:"flex",alignItems:"center",justifyContent:"center",fontSize:20,flexShrink:0}},s.icon),
          e("div",null,
            e("div",{style:{display:"flex",alignItems:"center",gap:8,marginBottom:5}},
              e("span",{className:"mn",style:{fontSize:10.5,fontWeight:600,color:"#2D6A4F",background:"#2D6A4F0E",padding:"2px 7px",borderRadius:4}},s.num),
              e("span",{style:{fontWeight:600,fontSize:15}},s.title)
            ),
            e("p",{style:{fontSize:13.5,color:"#777",lineHeight:1.65,margin:0}},s.desc)
          )
        );
      }),
      e("div",{style:{textAlign:"center",marginTop:28}},e("button",{onClick:function(){setPage("advisor")},style:{background:"#1A1A1A",color:"#fff",border:"none",fontFamily:"'Outfit',sans-serif",fontSize:14,fontWeight:600,padding:"13px 28px",borderRadius:10,cursor:"pointer"}},"Talk to your advisor"))
    );
  }

  // â”€â”€ PORTFOLIO PAGE â”€â”€
  function portfolioPage(){
    return e("div",{style:{animation:"fadeIn .4s ease"}},
      e("div",{style:{marginBottom:24}},
        e("h1",{className:"sf",style:{fontSize:26,fontWeight:700,letterSpacing:-.5,marginBottom:4}},"My Portfolio"),
        e("p",{style:{fontSize:13.5,color:"#999"}},"Your positions, risk profile & allocation")
      ),
      e("div",{style:{background:"linear-gradient(135deg,#1A1A1A 0%,#2D3436 100%)",borderRadius:18,padding:28,color:"#fff",marginBottom:16,position:"relative",overflow:"hidden"}},
        e("div",{style:{position:"absolute",top:-20,right:-20,width:100,height:100,borderRadius:"50%",background:"rgba(45,106,79,.15)"}}),
        e("div",{style:{fontSize:12,color:"rgba(255,255,255,.5)",fontWeight:500,marginBottom:4}},"Total portfolio value"),
        e("div",{className:"mn",style:{fontSize:34,fontWeight:700,letterSpacing:-1,marginBottom:4}},"$"+fmt(PORTFOLIO.totalValue)),
        e("div",{className:"mn",style:{fontSize:14,color:"#52B788",fontWeight:500}},"+$"+PORTFOLIO.dayChange.toFixed(2)+" (+"+PORTFOLIO.dayChangePct.toFixed(2)+"%) today")
      ),
      e("div",{style:{display:"flex",gap:10,marginBottom:16}},
        [{l:"Risk Score",v:PORTFOLIO.riskScore+"/10",s:PORTFOLIO.riskLabel,c:"#E76F51"},{l:"Diversification",v:PORTFOLIO.diversification+"%",s:"Well spread",c:"#2D6A4F"},{l:"ESG Score",v:PORTFOLIO.esgScore+"/100",s:"Good",c:"#52B788"}].map(function(s){
          return e("div",{key:s.l,style:{flex:1,background:"#fff",border:"1px solid #ECEAE3",borderRadius:14,padding:"16px 14px",textAlign:"center"}},
            e("div",{style:{fontSize:10.5,color:"#999",fontWeight:500,marginBottom:4}},s.l),
            e("div",{className:"mn",style:{fontSize:20,fontWeight:700,color:s.c,marginBottom:2}},s.v),
            e("div",{style:{fontSize:11,color:"#bbb",fontWeight:500}},s.s)
          );
        })
      ),
      e("div",{style:{background:"#fff",border:"1px solid #ECEAE3",borderRadius:16,padding:22,marginBottom:16}},
        e("div",{style:{fontSize:11,fontWeight:600,letterSpacing:1,textTransform:"uppercase",color:"#999",marginBottom:16}},"Your investor profile"),
        e("div",{style:{display:"flex",flexDirection:"column",gap:14}},
          PORTFOLIO.profile.map(function(p){
            return e("div",{key:p.label},
              e("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:5}},
                e("span",{style:{fontSize:13,fontWeight:500}},p.label),
                e("span",{className:"mn",style:{fontSize:12,fontWeight:600,color:p.color}},p.value)
              ),
              e(BarComp,{value:p.value,max:p.max,color:p.color})
            );
          })
        )
      ),
      e("div",{style:{background:"#fff",border:"1px solid #ECEAE3",borderRadius:16,padding:22,marginBottom:16}},
        e("div",{style:{fontSize:11,fontWeight:600,letterSpacing:1,textTransform:"uppercase",color:"#999",marginBottom:16}},"Allocation"),
        e("div",{style:{display:"flex",alignItems:"center",gap:24}},
          e(DonutComp,{data:PORTFOLIO.allocation}),
          e("div",{style:{display:"flex",flexDirection:"column",gap:8,flex:1}},
            PORTFOLIO.allocation.map(function(a){
              return e("div",{key:a.label,style:{display:"flex",alignItems:"center",gap:8}},
                e("div",{style:{width:10,height:10,borderRadius:3,background:a.color,flexShrink:0}}),
                e("span",{style:{fontSize:12,color:"#777",flex:1}},a.label),
                e("span",{className:"mn",style:{fontSize:12,fontWeight:600}},a.pct+"%")
              );
            })
          )
        )
      ),
      e("div",{style:{background:"#fff",border:"1px solid #ECEAE3",borderRadius:16,padding:22}},
        e("div",{style:{fontSize:11,fontWeight:600,letterSpacing:1,textTransform:"uppercase",color:"#999",marginBottom:14}},"Holdings"),
        PORTFOLIO.holdings.map(function(h,i){
          return e("div",{key:h.ticker,style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"12px 0",borderBottom:i<PORTFOLIO.holdings.length-1?"1px solid #F2F0EA":"none"}},
            e("div",null,
              e("div",{style:{display:"flex",alignItems:"center",gap:8,marginBottom:2}},e("span",{className:"mn",style:{fontSize:13,fontWeight:600}},h.ticker),e("span",{style:{fontSize:11,color:"#999"}},h.alloc+"%")),
              e("div",{style:{fontSize:12,color:"#aaa"}},h.name)
            ),
            e("div",{style:{textAlign:"right"}},
              e("div",{className:"mn",style:{fontSize:14,fontWeight:600}},"$"+fmt(h.value)),
              e("div",{className:"mn",style:{fontSize:11.5,fontWeight:500,color:up(h.change)?"#2D6A4F":"#C1484E"}},(up(h.change)?"+":"")+h.change.toFixed(2)+"%")
            )
          );
        })
      )
    );
  }

  // â”€â”€ AI ADVISOR PAGE â”€â”€
  function advisorPage(){
    return e("div",{style:{animation:"fadeIn .4s ease"}},
      // Hero
      e("div",{style:{marginBottom:20}},
        e("h1",{className:"sf",style:{fontSize:26,fontWeight:700,lineHeight:1.2,letterSpacing:-.5,marginBottom:6}},"AI Financial ",e("span",{style:{color:"#2D6A4F"}},"Advisor")),
        e("p",{style:{fontSize:13.5,color:"#999",lineHeight:1.5}},"MiFID II Investment Suitability Assessment \u2014 powered by on-premises AI")
      ),

      // Architecture bar
      e("div",{style:{display:"flex",gap:8,marginBottom:20,flexWrap:"wrap"}},
        [{label:"Brain: Ollama (On-Premises)",color:"#264653",bg:"#26465310"},{label:"Voice: ElevenLabs (STT+TTS)",color:"#2D6A4F",bg:"#2D6A4F10"},{label:"Backend: FastAPI",color:"#7B5EA7",bg:"#7B5EA710"}].map(function(a){
          return e("span",{key:a.label,style:{display:"inline-block",fontSize:10,fontWeight:600,padding:"5px 11px",borderRadius:50,background:a.bg,color:a.color,border:"1px solid "+a.color+"20",letterSpacing:.3}},a.label);
        })
      ),

      // Voice call card
      e("div",{style:{background:"linear-gradient(135deg,#1A1A1A 0%,#2D3436 100%)",borderRadius:18,padding:28,color:"#fff",marginBottom:16,position:"relative",overflow:"hidden"}},
        e("div",{style:{position:"absolute",top:-30,right:-30,width:120,height:120,borderRadius:"50%",background:"rgba(45,106,79,.12)"}}),
        e("div",{style:{display:"flex",alignItems:"center",gap:14,marginBottom:16}},
          e("div",{style:{width:48,height:48,borderRadius:14,background:"rgba(45,106,79,.2)",display:"flex",alignItems:"center",justifyContent:"center"}},e(MicIcon,{s:22,c:"#52B788"})),
          e("div",null,
            e("div",{style:{fontSize:16,fontWeight:600,marginBottom:2}},"Voice Assessment"),
            e("div",{style:{fontSize:12,color:"rgba(255,255,255,.5)"}},"Click the widget in the bottom-right corner to start a voice call")
          )
        ),
        e("div",{style:{display:"flex",gap:12}},
          [{v:"6 blocks",l:"Assessment"},{v:"~10 min",l:"Duration"},{v:"On-premises",l:"AI Processing"}].map(function(s){
            return e("div",{key:s.l,style:{flex:1,textAlign:"center",padding:"10px 6px",background:"rgba(255,255,255,.06)",borderRadius:10}},
              e("div",{className:"mn",style:{fontSize:14,fontWeight:600,color:"#52B788",marginBottom:2}},s.v),
              e("div",{style:{fontSize:10,color:"rgba(255,255,255,.4)",fontWeight:500}},s.l)
            );
          })
        )
      ),

      // Text chat
      e("div",{style:{background:"#fff",border:"1px solid #ECEAE3",borderRadius:16,padding:0,marginBottom:16,overflow:"hidden"}},
        e("div",{style:{padding:"16px 20px 12px",borderBottom:"1px solid #ECEAE3"}},
          e("div",{style:{fontSize:11,fontWeight:600,letterSpacing:1,textTransform:"uppercase",color:"#999"}},"Text conversation")
        ),
        e("div",{style:{minHeight:200,maxHeight:360,overflowY:"auto",padding:16}},
          advMessages.length===0?
            e("div",{style:{textAlign:"center",padding:"40px 20px"}},
              e("div",{style:{fontSize:28,marginBottom:10}},"\u{1F4AC}"),
              e("p",{style:{fontSize:13.5,color:"#bbb",lineHeight:1.6}},"Type a message below to begin the investment suitability assessment via text."),
              e("p",{style:{fontSize:12,color:"#ddd",marginTop:6}},"Or use the voice widget (bottom-right) for a spoken conversation.")
            )
          :
            e("div",{style:{display:"flex",flexDirection:"column",gap:10}},
              advMessages.map(function(m,i){
                return e("div",{key:i,style:{display:"flex",justifyContent:m.from==="user"?"flex-end":"flex-start"}},
                  e("div",{style:{maxWidth:"82%",padding:"10px 14px",borderRadius:m.from==="user"?"14px 14px 4px 14px":"14px 14px 14px 4px",background:m.from==="user"?"#1A1A1A":"#F6F5F0",color:m.from==="user"?"#fff":"#333",fontSize:13.5,lineHeight:1.55}},
                    m.from==="ai"?e("div",{style:{fontSize:10,color:"#2D6A4F",fontWeight:600,marginBottom:4}},"Advisor"):null,
                    m.text
                  )
                );
              }),
              advLoading?e("div",{style:{display:"flex",justifyContent:"flex-start"}},
                e("div",{style:{padding:"10px 14px",borderRadius:"14px 14px 14px 4px",background:"#F6F5F0",fontSize:13,color:"#999",animation:"pulse 1.5s infinite"}},
                  e("span",{style:{fontSize:10,color:"#2D6A4F",fontWeight:600,display:"block",marginBottom:4}},"Advisor"),
                  "Thinking..."
                )
              ):null,
              e("div",{ref:chatEndRef})
            )
        ),
        e("div",{style:{padding:"12px 16px",borderTop:"1px solid #ECEAE3",display:"flex",gap:8}},
          e("input",{value:advInput,onChange:function(ev){setAdvInput(ev.target.value)},onKeyDown:function(ev){if(ev.key==="Enter")sendAdvisorMsg()},placeholder:"Type a message to the advisor...",disabled:advLoading,
            style:{flex:1,border:"1px solid #E0DDD5",borderRadius:10,padding:"11px 14px",fontSize:13.5,fontFamily:"'Outfit',sans-serif",outline:"none",background:advLoading?"#f8f8f6":"#fff"}}),
          e("button",{onClick:sendAdvisorMsg,disabled:advLoading,
            style:{width:42,height:42,borderRadius:10,background:advLoading?"#999":"#1A1A1A",border:"none",display:"flex",alignItems:"center",justifyContent:"center",cursor:advLoading?"not-allowed":"pointer",flexShrink:0,transition:"all .2s"}},e(SendIcon))
        )
      ),

      // Audit trail toggle
      e("div",{style:{display:"flex",gap:10,marginBottom:16}},
        e("button",{onClick:function(){setShowAudit(!showAudit)},
          style:{flex:1,background:showAudit?"#264653":"#fff",color:showAudit?"#fff":"#264653",border:"1px solid "+(showAudit?"#264653":"#ECEAE3"),fontFamily:"'Outfit',sans-serif",fontSize:13,fontWeight:600,padding:"12px 20px",borderRadius:10,cursor:"pointer",transition:"all .2s"}
        },showAudit?"\u2715  Hide Audit Trail":"\u{1F50D}  Show Audit Trail (Explainability)"),
        e("button",{onClick:fetchAudit,
          style:{background:"#fff",color:"#999",border:"1px solid #ECEAE3",fontFamily:"'Outfit',sans-serif",fontSize:13,fontWeight:500,padding:"12px 16px",borderRadius:10,cursor:"pointer"}
        },"\u21BB")
      ),

      // Audit panel
      showAudit?e("div",{style:{animation:"fadeIn .3s ease"}},
        // Latest profile
        latestProfile&&latestProfile.result?e("div",{style:{background:"#fff",border:"1px solid #ECEAE3",borderRadius:16,padding:22,marginBottom:16}},
          e("div",{style:{fontSize:11,fontWeight:600,letterSpacing:1,textTransform:"uppercase",color:"#2D6A4F",marginBottom:14}},"Latest profile assessment"),
          e("div",{style:{display:"flex",alignItems:"center",gap:14,marginBottom:16}},
            e("div",{style:{background:"linear-gradient(135deg,#264653,#2D6A4F)",color:"#fff",padding:"10px 22px",borderRadius:50,fontSize:16,fontWeight:700}},latestProfile.result.profile),
            e("div",null,
              e("div",{className:"mn",style:{fontSize:14,fontWeight:600}},latestProfile.result.score),
              e("div",{style:{fontSize:11,color:"#999"}},"Total score")
            )
          ),
          // Block scores
          e("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:8,marginBottom:14}},
            Object.entries(latestProfile.result.explanation.block_scores).map(function(pair){
              return e("div",{key:pair[0],style:{display:"flex",justifyContent:"space-between",padding:"8px 12px",background:"#F6F5F0",borderRadius:8}},
                e("span",{style:{fontSize:12,color:"#777",textTransform:"capitalize"}},pair[0].replace(/_/g," ")),
                e("span",{className:"mn",style:{fontSize:12,fontWeight:600,color:"#264653"}},pair[1])
              );
            })
          ),
          // Restrictions
          latestProfile.result.explanation.restrictions_applied.length>0?
            e("div",{style:{marginBottom:14}},
              e("div",{style:{fontSize:11,fontWeight:600,color:"#E76F51",marginBottom:8,letterSpacing:.5}},"RESTRICTIONS APPLIED"),
              latestProfile.result.explanation.restrictions_applied.map(function(r,i){
                return e("div",{key:i,style:{padding:"10px 12px",background:"#FEF3EC",border:"1px solid #FDDCBC",borderRadius:8,marginBottom:6}},
                  e("div",{style:{fontSize:12,fontWeight:600,color:"#C4320A",marginBottom:2}},r.rule),
                  e("div",{style:{fontSize:11.5,color:"#9A3412"}},r.reason),
                  e("div",{style:{fontSize:11,fontWeight:600,color:"#E76F51",marginTop:3}},r.effect)
                );
              })
            ):null,
          // Allocation
          e("div",{style:{marginBottom:14}},
            e("div",{style:{fontSize:11,fontWeight:600,color:"#999",marginBottom:8,letterSpacing:.5}},"RECOMMENDED ALLOCATION"),
            Object.entries(latestProfile.result.allocation).map(function(pair){
              return e("div",{key:pair[0],style:{display:"flex",alignItems:"center",gap:10,marginBottom:5}},
                e("div",{style:{width:40,textAlign:"right"}},e("span",{className:"mn",style:{fontSize:12,fontWeight:600}},pair[1]+"%")),
                e("div",{style:{flex:1,height:8,background:"#ECEAE3",borderRadius:8}},
                  e("div",{style:{width:pair[1]+"%",height:"100%",background:"#2D6A4F",borderRadius:8,transition:"width .6s ease"}})
                ),
                e("span",{style:{fontSize:11.5,color:"#777",minWidth:80}},pair[0])
              );
            })
          ),
          // Products
          e("div",null,
            e("div",{style:{fontSize:11,fontWeight:600,color:"#999",marginBottom:8,letterSpacing:.5}},"SUITABLE PRODUCTS"),
            latestProfile.result.recommended_products.map(function(p,i){
              return e("div",{key:i,style:{display:"flex",alignItems:"center",gap:8,padding:"6px 0"}},
                e("div",{style:{width:6,height:6,borderRadius:3,background:"#2D6A4F",flexShrink:0}}),
                e("span",{style:{fontSize:12.5,color:"#555"}},p)
              );
            })
          ),
          e("div",{style:{marginTop:14,paddingTop:12,borderTop:"1px solid #ECEAE3",fontSize:10.5,color:"#bbb",fontStyle:"italic"}},latestProfile.result.disclaimer)
        ):null,

        // Audit log
        auditData?e("div",{style:{background:"#fff",border:"1px solid #ECEAE3",borderRadius:16,padding:22}},
          e("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:14}},
            e("div",{style:{fontSize:11,fontWeight:600,letterSpacing:1,textTransform:"uppercase",color:"#999"}},"Decision log"),
            e("span",{className:"mn",style:{fontSize:11,color:"#bbb"}},auditData.total_entries+" entries")
          ),
          e("div",{style:{fontSize:11,color:"#bbb",marginBottom:12}},"Model: "+auditData.model+" \xB7 "+auditData.server),
          e("div",{style:{maxHeight:300,overflowY:"auto"}},
            auditData.entries.slice().reverse().slice(0,15).map(function(en,i){
              var typeColors={llm_call:"#264653",profile_calculation:"#7B5EA7",text_chat:"#2D6A4F",elevenlabs_webhook:"#E76F51"};
              var tc=typeColors[en.type]||"#999";
              return e("div",{key:i,style:{padding:"8px 12px",margin:"4px 0",background:"#F6F5F0",borderRadius:8,borderLeft:"3px solid "+tc}},
                e("div",{style:{display:"flex",alignItems:"center",gap:6,marginBottom:3}},
                  e("span",{style:{display:"inline-block",fontSize:9,fontWeight:700,padding:"2px 7px",borderRadius:4,background:tc+"14",color:tc,letterSpacing:.4,textTransform:"uppercase"}},en.type.replace(/_/g," ")),
                  e("span",{style:{fontSize:10,color:"#ccc"}},en.timestamp)
                ),
                en.last_user_message?e("div",{style:{fontSize:11.5,color:"#777",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"}},"User: "+en.last_user_message):null,
                en.response?e("div",{style:{fontSize:11.5,color:"#555",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"}},"AI: "+en.response):null,
                en.profile?e("div",{style:{fontSize:11.5,color:"#7B5EA7",fontWeight:600}},"Profile: "+en.profile+" (score "+en.score+")"):null
              );
            })
          )
        ):null
      ):null,

      // Footer
      e("div",{style:{textAlign:"center",padding:"28px 0 0",marginTop:8}},
        e("p",{style:{fontSize:11,color:"#ccc",lineHeight:1.7}},"All decisions made on-premises by Ollama (llama3.1:8b) \xB7 ElevenLabs provides voice only"),
        e("p",{style:{fontSize:10,color:"#ddd",marginTop:4}},"MiFID II Directive 2014/65/EU \xB7 Demo purposes only \xB7 Not financial advice")
      )
    );
  }

  return e("div",{style:{minHeight:"100vh",background:"#F6F5F0",color:"#1A1A1A",fontFamily:"'Outfit',sans-serif"}},
    header,
    modal,
    e("main",{style:{maxWidth:540,margin:"0 auto",padding:"24px 20px 120px"}},
      page==="invest"?investPage():null,
      page==="how"?howPage():null,
      page==="portfolio"?portfolioPage():null,
      page==="advisor"?advisorPage():null
    )
  );
}

ReactDOM.render(e(App),document.getElementById("root"));
</script>
</body>
</html>
